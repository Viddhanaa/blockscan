# =============================================================================
# Viddhana Blockscan - Logrotate Configuration
# Phase 4: Explorer Infrastructure
# =============================================================================

# -----------------------------------------------------------------------------
# Blockscout Application Logs
# -----------------------------------------------------------------------------
/var/log/blockscout/*.log {
    daily
    rotate 7
    missingok
    notifempty
    compress
    delaycompress
    copytruncate
    dateext
    dateformat -%Y%m%d
    maxsize 100M
    create 0640 root adm
    sharedscripts
    postrotate
        # Send HUP signal to reload log files if needed
        docker kill --signal=HUP viddhana-blockscout-backend 2>/dev/null || true
    endscript
}

# -----------------------------------------------------------------------------
# PostgreSQL Logs
# -----------------------------------------------------------------------------
/var/log/postgresql/*.log {
    daily
    rotate 7
    missingok
    notifempty
    compress
    delaycompress
    copytruncate
    dateext
    dateformat -%Y%m%d
    maxsize 100M
    create 0640 postgres adm
}

# -----------------------------------------------------------------------------
# Redis Logs
# -----------------------------------------------------------------------------
/var/log/redis/*.log {
    daily
    rotate 7
    missingok
    notifempty
    compress
    delaycompress
    copytruncate
    dateext
    dateformat -%Y%m%d
    maxsize 50M
    create 0640 redis adm
}

# -----------------------------------------------------------------------------
# Smart Contract Verifier Logs
# -----------------------------------------------------------------------------
/var/log/sc-verifier/*.log {
    daily
    rotate 7
    missingok
    notifempty
    compress
    delaycompress
    copytruncate
    dateext
    dateformat -%Y%m%d
    maxsize 50M
    create 0640 root adm
}

# -----------------------------------------------------------------------------
# Frontend Logs
# -----------------------------------------------------------------------------
/var/log/blockscout-frontend/*.log {
    daily
    rotate 7
    missingok
    notifempty
    compress
    delaycompress
    copytruncate
    dateext
    dateformat -%Y%m%d
    maxsize 50M
    create 0640 root adm
}

# -----------------------------------------------------------------------------
# Docker Container Logs (Alternative path)
# -----------------------------------------------------------------------------
/var/lib/docker/containers/*/*.log {
    daily
    rotate 7
    missingok
    notifempty
    compress
    delaycompress
    copytruncate
    dateext
    dateformat -%Y%m%d
    maxsize 200M
    create 0640 root root
}

# -----------------------------------------------------------------------------
# Viddhana Blockscan Project Logs
# -----------------------------------------------------------------------------
/home/realcodes/VIddhana_blockscan/logs/*.log {
    daily
    rotate 7
    missingok
    notifempty
    compress
    delaycompress
    copytruncate
    dateext
    dateformat -%Y%m%d
    maxsize 100M
    create 0644 realcodes realcodes
}

# -----------------------------------------------------------------------------
# Backup Script Logs
# -----------------------------------------------------------------------------
/home/realcodes/VIddhana_blockscan/blockscout/logs/*.log {
    daily
    rotate 7
    missingok
    notifempty
    compress
    delaycompress
    copytruncate
    dateext
    dateformat -%Y%m%d
    maxsize 50M
    create 0644 realcodes realcodes
}
